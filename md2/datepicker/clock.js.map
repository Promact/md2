{"version":3,"file":"clock.js","sourceRoot":"","sources":["../../../src/lib/datepicker/clock.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  ElementRef,\n  Input,\n  Output,\n  EventEmitter,\n  ViewEncapsulation,\n} from '@angular/core';\n\nexport const CLOCK_HOURS = 24;\nexport const CLOCK_MINUTES = 60;\nexport const CLOCK_RADIUS = 120;\nexport const CLOCK_INNER_RADIUS = 66;\nexport const CLOCK_OUTER_RADIUS = 99;\nexport const CLOCK_TICK_RADIUS = 17;\n\n@Component({\n  moduleId: module.id,\n  selector: 'md2-clock',\n  templateUrl: 'clock.html',\n  styleUrls: ['datepicker.css'],\n  host: {\n    'role': 'clock',\n    '(mousedown)': '_handleMousedown($event)',\n  },\n  encapsulation: ViewEncapsulation.None\n})\nexport class Md2Clock {\n\n  private mouseMoveListener: any;\n  private mouseUpListener: any;\n\n  private _time: string;\n\n  _view: boolean = true;\n\n  _hours: Array<Object> = [];\n  _minutes: Array<Object> = [];\n\n  _hour: number = 0;\n  _minute: number = 0;\n\n  constructor(private _element: ElementRef) {\n    this.renderClock();\n    this.mouseMoveListener = (event: any) => { this._handleMousemove(event); };\n    this.mouseUpListener = (event: any) => { this._handleMouseup(event); };\n  }\n\n  @Output() timeChange: EventEmitter<string> = new EventEmitter<string>();\n  @Output() onHourChange: EventEmitter<number> = new EventEmitter<number>();\n  @Output() onMinuteChange: EventEmitter<number> = new EventEmitter<number>();\n\n  @Input()\n  get time() { return this._time; }\n  set time(value: string) {\n    if (this._time !== value) {\n      this._time = value || '00:00';\n      this._hour = parseInt(this._time.split(':')[0]);\n      this._minute = parseInt(this._time.split(':')[1]);\n    }\n  }\n\n  @Input()\n  set view(value: string) {\n    if (value === 'minute') {\n      this._view = false;\n    } else { this._view = true; }\n  }\n\n  get hand(): any {\n    let deg = 0;\n    let radius = CLOCK_OUTER_RADIUS;\n    if (this._view) {\n      let inner = this._hour > 0 && this._hour < 13;\n      radius = inner ? CLOCK_INNER_RADIUS : CLOCK_OUTER_RADIUS;\n      deg = Math.round(this._hour * (360 / (CLOCK_HOURS / 2)));\n    } else {\n      deg = Math.round(this._minute * (360 / CLOCK_MINUTES));\n    }\n\n    return {\n      'transform': `rotate(${deg}deg)`,\n      'height': `${radius}px`,\n      'margin-top': `${120 - radius}px`\n    };\n  }\n\n  _handleMousedown(event: any) {\n    this.setTime(event);\n    document.addEventListener('mousemove', this.mouseMoveListener);\n    document.addEventListener('touchmove', this.mouseMoveListener);\n    document.addEventListener('mouseup', this.mouseUpListener);\n    document.addEventListener('touchend', this.mouseUpListener);\n  }\n\n  _handleMousemove(event: any) {\n    event.preventDefault();\n    this.setTime(event);\n  }\n\n  _handleMouseup(event: any) {\n    document.removeEventListener('mousemove', this.mouseMoveListener);\n    document.removeEventListener('touchmove', this.mouseMoveListener);\n    document.removeEventListener('mouseup', this.mouseUpListener);\n    document.removeEventListener('touchend', this.mouseUpListener);\n    if (this._view) {\n      this.onHourChange.emit(this._hour);\n    } else {\n      this.onMinuteChange.emit(this._minute);\n    }\n  }\n\n  _handleKeydown(event: KeyboardEvent) { }\n\n  /** Emits an event when the user selects a time. */\n  _emitChangeEvent(): void {\n    this.timeChange.emit(this.time);\n  }\n\n  /**\n   * render Click\n   */\n  private renderClock() {\n    this._hours.length = 0;\n\n    for (let i = 0; i < CLOCK_HOURS; i++) {\n      let radian = i / 6 * Math.PI;\n      let inner = i > 0 && i < 13,\n        radius = inner ? CLOCK_INNER_RADIUS : CLOCK_OUTER_RADIUS;\n      this._hours.push({\n        hour: i === 0 ? '00' : i,\n        top: CLOCK_RADIUS - Math.cos(radian) * radius - CLOCK_TICK_RADIUS,\n        left: CLOCK_RADIUS + Math.sin(radian) * radius - CLOCK_TICK_RADIUS\n      });\n    }\n\n    for (let i = 0; i < CLOCK_MINUTES; i += 5) {\n      let radian = i / 30 * Math.PI;\n      this._minutes.push({\n        minute: i === 0 ? '00' : i,\n        top: CLOCK_RADIUS - Math.cos(radian) * CLOCK_OUTER_RADIUS - CLOCK_TICK_RADIUS,\n        left: CLOCK_RADIUS + Math.sin(radian) * CLOCK_OUTER_RADIUS - CLOCK_TICK_RADIUS\n      });\n    }\n  }\n\n  /**\n   * Set Time\n   * @param event\n   */\n  private setTime(event: any) {\n    let trigger = this._element.nativeElement;\n    let triggerRect = trigger.getBoundingClientRect();\n    let width = trigger.offsetWidth;\n    let height = trigger.offsetHeight;\n    let pageX = event.pageX !== undefined ? event.pageX : event.touches[0].pageX;\n    let pageY = event.pageY !== undefined ? event.pageY : event.touches[0].pageY;\n    let x = (width / 2) - (pageX - triggerRect.left - window.pageXOffset);\n    let y = (height / 2) - (pageY - triggerRect.top - window.pageYOffset);\n    let radian = Math.atan2(-x, y);\n    let unit = Math.PI / (this._view ? 6 : 30);\n    let z = Math.sqrt(x * x + y * y);\n    let inner = this._view && z < (CLOCK_OUTER_RADIUS + CLOCK_INNER_RADIUS) / 2;\n    let value = 0;\n\n    if (radian < 0) { radian = Math.PI * 2 + radian; }\n    value = Math.round(radian / unit);\n    radian = value * unit;\n\n    if (this._view) {\n      if (value === 12) { value = 0; }\n      value = inner ? (value === 0 ? 12 : value) : value === 0 ? 0 : value + 12;\n      this._hour = value;\n    } else {\n      if (value === 60) { value = 0; }\n      this._minute = value;\n    }\n    this._time = this._hour + ':' + this._minute;\n    this._emitChangeEvent();\n  }\n\n}\n"]}