{"version":3,"sources":["core/portal/portal-directives.ts"],"names":[],"mappings":"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","file":"core/portal/portal-directives.js","sourcesContent":["import {\r\n    NgModule,\r\n    ModuleWithProviders,\r\n    ComponentRef,\r\n    Directive,\r\n    TemplateRef,\r\n    ComponentFactoryResolver,\r\n    ViewContainerRef\r\n} from '@angular/core';\r\nimport {Portal, TemplatePortal, ComponentPortal, BasePortalHost} from './portal';\r\n\r\n\r\n/**\r\n * Directive version of a `TemplatePortal`. Because the directive *is* a TemplatePortal,\r\n * the directive instance itself can be attached to a host, enabling declarative use of portals.\r\n *\r\n * Usage:\r\n * <template portal #greeting>\r\n *   <p> Hello {{name}} </p>\r\n * </template>\r\n */\r\n@Directive({\r\n  selector: '[portal]',\r\n  exportAs: 'portal',\r\n})\r\nexport class TemplatePortalDirective extends TemplatePortal {\r\n  constructor(templateRef: TemplateRef<any>, viewContainerRef: ViewContainerRef) {\r\n    super(templateRef, viewContainerRef);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * Directive version of a PortalHost. Because the directive *is* a PortalHost, portals can be\r\n * directly attached to it, enabling declarative use.\r\n *\r\n * Usage:\r\n * <template [portalHost]=\"greeting\"></template>\r\n */\r\n@Directive({\r\n  selector: '[portalHost]',\r\n  inputs: ['portal: portalHost']\r\n})\r\nexport class PortalHostDirective extends BasePortalHost {\r\n  /** The attached portal. */\r\n  private _portal: Portal<any>;\r\n\r\n  constructor(\r\n      private _componentFactoryResolver: ComponentFactoryResolver,\r\n      private _viewContainerRef: ViewContainerRef) {\r\n    super();\r\n  }\r\n\r\n  get portal(): Portal<any> {\r\n    return this._portal;\r\n  }\r\n\r\n  set portal(p: Portal<any>) {\r\n    this._replaceAttachedPortal(p);\r\n  }\r\n\r\n  /** Attach the given ComponentPortal to this PortlHost using the ComponentFactoryResolver. */\r\n  attachComponentPortal<T>(portal: ComponentPortal<T>): ComponentRef<T> {\r\n    portal.setAttachedHost(this);\r\n\r\n    // If the portal specifies an origin, use that as the logical location of the component\r\n    // in the application tree. Otherwise use the location of this PortalHost.\r\n    let viewContainerRef = portal.viewContainerRef != null ?\r\n        portal.viewContainerRef :\r\n        this._viewContainerRef;\r\n\r\n    let componentFactory =\r\n        this._componentFactoryResolver.resolveComponentFactory(portal.component);\r\n    let ref = viewContainerRef.createComponent(\r\n        componentFactory, viewContainerRef.length,\r\n        portal.injector || viewContainerRef.parentInjector);\r\n\r\n    this.setDisposeFn(() => ref.destroy());\r\n    return ref;\r\n  }\r\n\r\n  /** Attach the given TemplatePortal to this PortlHost as an embedded View. */\r\n  attachTemplatePortal(portal: TemplatePortal): Map<string, any> {\r\n    portal.setAttachedHost(this);\r\n\r\n    this._viewContainerRef.createEmbeddedView(portal.templateRef);\r\n    this.setDisposeFn(() => this._viewContainerRef.clear());\r\n\r\n    // TODO(jelbourn): return locals from view\r\n    return new Map<string, any>();\r\n  }\r\n\r\n  /** Detatches the currently attached Portal (if there is one) and attaches the given Portal. */\r\n  private _replaceAttachedPortal(p: Portal<any>): void {\r\n    if (this.hasAttached()) {\r\n      this.detach();\r\n    }\r\n\r\n    if (p) {\r\n      this.attach(p);\r\n      this._portal = p;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n@NgModule({\r\n  exports: [TemplatePortalDirective, PortalHostDirective],\r\n  declarations: [TemplatePortalDirective, PortalHostDirective],\r\n})\r\nexport class PortalModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: PortalModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"/source/"}