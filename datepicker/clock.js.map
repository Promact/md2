{"version":3,"file":"clock.js","sourceRoot":"","sources":["../../../src/lib/datepicker/clock.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n  Component,\r\n  ElementRef,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  ViewEncapsulation,\r\n} from '@angular/core';\r\n\r\nexport const CLOCK_HOURS = 24;\r\nexport const CLOCK_MINUTES = 60;\r\nexport const CLOCK_RADIUS = 120;\r\nexport const CLOCK_INNER_RADIUS = 66;\r\nexport const CLOCK_OUTER_RADIUS = 99;\r\nexport const CLOCK_TICK_RADIUS = 17;\r\n\r\n@Component({\r\n  moduleId: module.id,\r\n  selector: 'md2-clock',\r\n  templateUrl: 'clock.html',\r\n  styleUrls: ['datepicker.css'],\r\n  host: {\r\n    'role': 'clock',\r\n    '(mousedown)': '_handleMousedown($event)',\r\n  },\r\n  encapsulation: ViewEncapsulation.None\r\n})\r\nexport class Md2Clock {\r\n\r\n  private mouseMoveListener: any;\r\n  private mouseUpListener: any;\r\n\r\n  private _time: string;\r\n\r\n  _view: boolean = true;\r\n\r\n  _hours: Array<Object> = [];\r\n  _minutes: Array<Object> = [];\r\n\r\n  _hour: number = 0;\r\n  _minute: number = 0;\r\n\r\n  constructor(private _element: ElementRef) {\r\n    this.renderClock();\r\n    this.mouseMoveListener = (event: any) => { this._handleMousemove(event); };\r\n    this.mouseUpListener = (event: any) => { this._handleMouseup(event); };\r\n  }\r\n\r\n  @Output() timeChange: EventEmitter<string> = new EventEmitter<string>();\r\n  @Output() onHourChange: EventEmitter<number> = new EventEmitter<number>();\r\n  @Output() onMinuteChange: EventEmitter<number> = new EventEmitter<number>();\r\n\r\n  @Input()\r\n  get time() { return this._time; }\r\n  set time(value: string) {\r\n    if (this._time !== value) {\r\n      this._time = value || '00:00';\r\n      this._hour = parseInt(this._time.split(':')[0]);\r\n      this._minute = parseInt(this._time.split(':')[1]);\r\n    }\r\n  }\r\n\r\n  @Input()\r\n  set view(value: string) {\r\n    if (value === 'minute') {\r\n      this._view = false;\r\n    } else { this._view = true; }\r\n  }\r\n\r\n  get hand(): any {\r\n    let deg = 0;\r\n    let radius = CLOCK_OUTER_RADIUS;\r\n    if (this._view) {\r\n      let inner = this._hour > 0 && this._hour < 13;\r\n      radius = inner ? CLOCK_INNER_RADIUS : CLOCK_OUTER_RADIUS;\r\n      deg = Math.round(this._hour * (360 / (CLOCK_HOURS / 2)));\r\n    } else {\r\n      deg = Math.round(this._minute * (360 / CLOCK_MINUTES));\r\n    }\r\n\r\n    return {\r\n      'transform': `rotate(${deg}deg)`,\r\n      'height': `${radius}px`,\r\n      'margin-top': `${120 - radius}px`\r\n    };\r\n  }\r\n\r\n  _handleMousedown(event: any) {\r\n    this.setTime(event);\r\n    document.addEventListener('mousemove', this.mouseMoveListener);\r\n    document.addEventListener('touchmove', this.mouseMoveListener);\r\n    document.addEventListener('mouseup', this.mouseUpListener);\r\n    document.addEventListener('touchend', this.mouseUpListener);\r\n  }\r\n\r\n  _handleMousemove(event: any) {\r\n    event.preventDefault();\r\n    this.setTime(event);\r\n  }\r\n\r\n  _handleMouseup(event: any) {\r\n    document.removeEventListener('mousemove', this.mouseMoveListener);\r\n    document.removeEventListener('touchmove', this.mouseMoveListener);\r\n    document.removeEventListener('mouseup', this.mouseUpListener);\r\n    document.removeEventListener('touchend', this.mouseUpListener);\r\n    if (this._view) {\r\n      this.onHourChange.emit(this._hour);\r\n    } else {\r\n      this.onMinuteChange.emit(this._minute);\r\n    }\r\n  }\r\n\r\n  _handleKeydown(event: KeyboardEvent) { }\r\n\r\n  /** Emits an event when the user selects a time. */\r\n  _emitChangeEvent(): void {\r\n    this.timeChange.emit(this.time);\r\n  }\r\n\r\n  /**\r\n   * render Click\r\n   */\r\n  private renderClock() {\r\n    this._hours.length = 0;\r\n\r\n    for (let i = 0; i < CLOCK_HOURS; i++) {\r\n      let radian = i / 6 * Math.PI;\r\n      let inner = i > 0 && i < 13,\r\n        radius = inner ? CLOCK_INNER_RADIUS : CLOCK_OUTER_RADIUS;\r\n      this._hours.push({\r\n        hour: i === 0 ? '00' : i,\r\n        top: CLOCK_RADIUS - Math.cos(radian) * radius - CLOCK_TICK_RADIUS,\r\n        left: CLOCK_RADIUS + Math.sin(radian) * radius - CLOCK_TICK_RADIUS\r\n      });\r\n    }\r\n\r\n    for (let i = 0; i < CLOCK_MINUTES; i += 5) {\r\n      let radian = i / 30 * Math.PI;\r\n      this._minutes.push({\r\n        minute: i === 0 ? '00' : i,\r\n        top: CLOCK_RADIUS - Math.cos(radian) * CLOCK_OUTER_RADIUS - CLOCK_TICK_RADIUS,\r\n        left: CLOCK_RADIUS + Math.sin(radian) * CLOCK_OUTER_RADIUS - CLOCK_TICK_RADIUS\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set Time\r\n   * @param event\r\n   */\r\n  private setTime(event: any) {\r\n    let trigger = this._element.nativeElement;\r\n    let triggerRect = trigger.getBoundingClientRect();\r\n    let width = trigger.offsetWidth;\r\n    let height = trigger.offsetHeight;\r\n    let pageX = event.pageX !== undefined ? event.pageX : event.touches[0].pageX;\r\n    let pageY = event.pageY !== undefined ? event.pageY : event.touches[0].pageY;\r\n    let x = (width / 2) - (pageX - triggerRect.left - window.pageXOffset);\r\n    let y = (height / 2) - (pageY - triggerRect.top - window.pageYOffset);\r\n    let radian = Math.atan2(-x, y);\r\n    let unit = Math.PI / (this._view ? 6 : 30);\r\n    let z = Math.sqrt(x * x + y * y);\r\n    let inner = this._view && z < (CLOCK_OUTER_RADIUS + CLOCK_INNER_RADIUS) / 2;\r\n    let value = 0;\r\n\r\n    if (radian < 0) { radian = Math.PI * 2 + radian; }\r\n    value = Math.round(radian / unit);\r\n    radian = value * unit;\r\n\r\n    if (this._view) {\r\n      if (value === 12) { value = 0; }\r\n      value = inner ? (value === 0 ? 12 : value) : value === 0 ? 0 : value + 12;\r\n      this._hour = value;\r\n    } else {\r\n      if (value === 60) { value = 0; }\r\n      this._minute = value;\r\n    }\r\n    this._time = this._hour + ':' + this._minute;\r\n    this._emitChangeEvent();\r\n  }\r\n\r\n}\r\n"]}